<!DOCTYPE html><html lang="en"><head><script src="/config.1db3ccebebfb06c06c39.js"></script><meta charset="utf-8"><title>借助云主机，在外也能访问家中的Home Assistant - Birch's Blog</title><base href="/"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="canonical" href="http://wardzhou.art/2023/08/03/ha-frp/"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="description" content="Home Assistant (HA)，靠其强大的功能、可拓展性、和社区支持，得到了很多智能家居爱好者的青睐。而在内地复杂的宽带环境下，如何在局域网外访问HA成为最大的痛点之一。如果你正巧有自己的域名和云服务器，那么这篇指南可能是个不错的选择。 Updated on Aug. 23 —— 增加frpc服务连接失败自动重连配置  10秒速读：本文通过FRP在服务器端和客户端搭建通道，并通过Nginx"><meta property="og:type" content="website"><meta property="og:title" content="借助云主机，在外也能访问家中的Home Assistant"><meta property="og:url" content="http://wardzhou.art/2023/08/03/ha-frp/index.html"><meta property="og:site_name" content="Birch's Blog"><meta property="og:description" content="Home Assistant (HA)，靠其强大的功能、可拓展性、和社区支持，得到了很多智能家居爱好者的青睐。而在内地复杂的宽带环境下，如何在局域网外访问HA成为最大的痛点之一。如果你正巧有自己的域名和云服务器，那么这篇指南可能是个不错的选择。 Updated on Aug. 23 —— 增加frpc服务连接失败自动重连配置  10秒速读：本文通过FRP在服务器端和客户端搭建通道，并通过Nginx"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp"><meta property="article:published_time" content="2023-08-02T17:35:55.000Z"><meta property="article:modified_time" content="2024-01-24T16:56:18.136Z"><meta property="article:author" content="Birch"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Nginx"><meta property="article:tag" content="HomeAssistant"><meta property="article:tag" content="SmartHome"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp"><script type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","publisher":{"@type":"Person","name":"Birch","description":"> ","image":"https://wardzhou.art/img/avatar.jpeg"},"url":"http://wardzhou.art","image":"https://wardzhou.art/img/avatar.jpeg","description":"Just a Blog.","author":{"@type":"Person","name":"Birch","description":"> ","image":"https://wardzhou.art/img/avatar.jpeg"},"inLanguage":{"@type":"Language","alternateName":"en"}},{"@context":"http://schema.org","@type":"Article","articleSection":"教程","url":"http://wardzhou.art/2023/08/03/ha-frp/","headline":"借助云主机，在外也能访问家中的Home Assistant","image":"https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp","datePublished":"2023-08-02T17:35:55.000Z","dateModified":"2024-01-24T16:56:18.136Z","keywords":"Linux,Nginx,HomeAssistant,SmartHome","description":"Just a Blog.","publisher":{"@type":"Organization","name":"Birch's Blog","logo":{"@type":"ImageObject","url":"https://wardzhou.art/img/avatar.jpeg"}},"author":{"@type":"Person","name":"Birch","description":"> ","image":"https://wardzhou.art/img/avatar.jpeg"},"inLanguage":{"@type":"Language","alternateName":"en"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://wardzhou.art/2023/08/03/ha-frp/"},"thumbnailUrl":"https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp"}]</script><link rel="alternate" type="application/atom+xml" title="Birch's Blog" href="/atom.xml"><script async="" src="//www.googletagmanager.com/gtag/js?id=G-3P92CH3710"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3P92CH3710")</script><style is="theme">html{--inside-accent-color:#6699CC;--inside-foreground-color:#333333;--inside-border-color:#e0e0e0;--inside-background:#f3f6f7;--inside-sidebar-background:#6699CC linear-gradient(to bottom,#66CCCC 0%,#6699CC 100%);--inside-card-background:#fff;--inside-font-base:'IBM Plex Mono','Noto Sans SC';--inside-font-logo:'Noto Serif SC','IBM Plex Mono','Noto Sans SC';--inside-font-menu:IBM Plex Mono,'IBM Plex Mono','Noto Sans SC';--inside-font-heading:'IBM Plex Mono-SemiBold','Noto Sans SC-Medium','IBM Plex Mono','Noto Sans SC';--inside-font-label:Oxanium,'IBM Plex Mono','Noto Sans SC';--inside-font-code:'IBM Plex Mono','Noto Sans SC';--inside-font-print:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif;--inside-content-width:660px;--inside-highlight-00:#263238;--inside-highlight-01:#2c393f;--inside-highlight-02:#37474f;--inside-highlight-03:#707880;--inside-highlight-04:#c9ccd3;--inside-highlight-05:#cdd3de;--inside-highlight-06:#d5dbe5;--inside-highlight-07:#ffffff;--inside-highlight-08:#ec5f67;--inside-highlight-09:#ea9560;--inside-highlight-0a:#ffcc00;--inside-highlight-0b:#8bd649;--inside-highlight-0c:#80cbc4;--inside-highlight-0d:#89ddff;--inside-highlight-0e:#82aaff;--inside-highlight-0f:#ec5f67;--inside-card-color:#fff;--inside-accent-color-005:rgba(102,153,204,.05);--inside-accent-color-01:rgba(102,153,204,.1);--inside-accent-color-02:rgba(102,153,204,.2);--inside-accent-color-04:rgba(102,153,204,.4);--inside-accent-color-08:rgba(102,153,204,.8)}</style><script src="/theme.9ecc9ab1.js"></script><link href="https://cdn.wardzhou.art/lib/font.css" rel="stylesheet"><script src="/cipher.0329a0a9.js"></script><script src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="apple-touch-icon" href="/favicon.ico"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon-precomposed" href="/img/512.png"><meta name="theme-color" content=""><script>console.log("被你逮到咯...⁄(⁄ ⁄•⁄ω⁄•⁄ ⁄)⁄....")</script><link href="/styles.91e7dfca63c7c151daa6.css" rel="stylesheet"><meta name="generator" content="Hexo 6.3.0"><script type="application/json" is="state">{&q;api/MjAyMy8wOC8wMy9oYS1mcnA.json&q;:{&q;title&q;:&q;借助云主机，在外也能访问家中的Home Assistant&q;,&q;date&q;:&q;2023-08-02T17:35:55.000Z&q;,&q;date_formatted&q;:{&q;ll&q;:&q;Aug 3, 2023&q;,&q;L&q;:&q;08/03/2023&q;,&q;MM-DD&q;:&q;08-03&q;},&q;author&q;:&q;Ward&q;,&q;thumbnail&q;:&q;https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp&q;,&q;link&q;:&q;2023/08/03/ha-frp&q;,&q;comments&q;:true,&q;tags&q;:[&q;HomeAssistant&q;,&q;Linux&q;,&q;Nginx&q;,&q;SmartHome&q;],&q;categories&q;:[&q;教程&q;],&q;updated&q;:&q;2024-01-24T16:56:18.136Z&q;,&q;content&q;:&q;&l;p&g;Home Assistant (HA)，靠其强大的功能、可拓展性、和社区支持，得到了很多智能家居爱好者的青睐。而在内地复杂的宽带环境下，如何在局域网外访问HA成为最大的痛点之一。如果你正巧有自己的域名和云服务器，那么这篇指南可能是个不错的选择。&l;/p&g;\n&l;p&g;Updated on Aug. 23 —— 增加frpc服务连接失败自动重连配置&l;/p&g;\n&l;blockquote&g;\n&l;p&g;&l;strong&g;10秒速读：本文通过FRP在服务器端和客户端搭建通道，并通过Nginx反向代理来实现自定义域名访问家中的HA实例。&l;/strong&g;&l;/p&g;\n&l;p&g;环境：Linux&l;/p&g;\n&l;p&g;需要准备：&l;/p&g;\n&l;ul&g;\n&l;li&g;有公网IP的云服务器，并预装Linux系统；&l;/li&g;\n&l;li&g;通过&l;a href=\&q;https://www.home-assistant.io/installation/linux\&q; target=\&q;_blank\&q;&g;原生OS/Supervisor&l;/a&g;方式部署好的HA客户端（VM或者Docker可能会有未知问题）&l;/li&g;\n&l;li&g;一些耐心&l;/li&g;\n&l;/ul&g;\n&l;/blockquote&g;\n&l;h2 id=\&q;1.服务器端配置\&q;&g;1.服务器端配置&l;a title=\&q;#1.服务器端配置\&q; href=\&q;#1.服务器端配置\&q;&g;&l;/a&g;&l;/h2&g;\n&l;h3 id=\&q;1.1下载\&q;&g;1.1下载&l;a title=\&q;#1.1下载\&q; href=\&q;#1.1下载\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;FRP软件包包含两部分：服务器端的FRPS和客户端的FRPC，该软件包提供跨平台支持，所以需要确定你服务器的架构。使用下面的命令输出：&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;uname&l;/span&g; -m&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;在下面的链接（可能需要魔法访问）复制对应架构的最新版的链接：&l;/p&g;\n&l;p&g;&l;a href=\&q;https://github.com/fatedier/frp/releases\&q; target=\&q;_blank\&q;&g;Releases · fatedier/frp (github.com)&l;/a&g;&l;/p&g;\n&l;p&g;下面amd64为例&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;cd&l;/span&g; /home/&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 下载&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;wget https://github.com/fatedier/frp/releases/download/v0.51.2/frp_0.51.2_linux_amd64.tar.gz&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 创建文件夹解压&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;mkdir&l;/span&g; frp&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;tar -xzf frp_0.51.2_linux_amd64.tar.gz -C frp&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 进入目录&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;cd&l;/span&g; frp/frp_0.51.2_linux_amd64/&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h3 id=\&q;1.2配置frps\&q;&g;1.2配置FRPS&l;a title=\&q;#1.2配置frps\&q; href=\&q;#1.2配置frps\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;修改配置文件 &l;code&g;frps.ini&l;/code&g;&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;sudo vim  frps.ini&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;文件内容：&l;/p&g;\n&l;figure class=\&q;highlight ini\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;section\&q;&g;[common]&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;bind_port&l;/span&g; = &l;span class=\&q;number\&q;&g;7000&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;vhost_http_port&l;/span&g; = &l;span class=\&q;number\&q;&g;9000&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;auto_token&l;/span&g; = &l;span class=\&q;number\&q;&g;123456&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;vim文件编辑器内输入&l;code&g;i&l;/code&g;进入编辑模式。&l;/p&g;\n&l;p&g;&l;code&g;bind_port&l;/code&g;是需要绑定的服务器端口，&l;code&g;vhost_http_port&l;/code&g;是你希望通过服务器访问的端口，需要提前确认这两个端口没有被占用&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 查询端口占用&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;netstat -ntlp&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;&l;code&g;auto_token&l;/code&g;是用来认证的密钥，可以自定义&l;/p&g;\n&l;p&g;配置完成后，按ESC退出编辑模式，输入&l;code&g;:w&l;/code&g;并按回车，紧接着输入&l;code&g;:q&l;/code&g;并按回车保存退出&l;/p&g;\n&l;h3 id=\&q;1.3配置开机自启\&q;&g;1.3配置开机自启&l;a title=\&q;#1.3配置开机自启\&q; href=\&q;#1.3配置开机自启\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;创建一个服务，便于管理并随开机自动运行&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;cp&l;/span&g; frps /usr/local/bin/frps&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;mkdir&l;/span&g; /etc/frp/  &l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;cp&l;/span&g; frps.ini /etc/frp/frps.ini &l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo vim /etc/systemd/system/frps.service&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;创建服务配置文件&l;/p&g;\n&l;figure class=\&q;highlight plaintext\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;[Unit]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 服务名称，可自定义&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Description = frp server&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;After = network.target syslog.target&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Wants = network.target&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;[Service]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Type = simple&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 启动frps的命令，需修改为您的frps的安装路径&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;ExecStart=/usr/local/bin/frps -c /etc/frp/frps.ini&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;[Install]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;WantedBy = multi-user.target&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;编辑和保存命令同上&l;/p&g;\n&l;p&g;开启服务，并配置开机启动&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;systemctl start frps&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;systemctl &l;span class=\&q;built_in\&q;&g;enable&l;/span&g; frps&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;查看是否运行成功&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;systemctl status frps&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;云服务器一般有安全管理，需要去控制台开放端口，示例里为&l;code&g;7000&l;/code&g;和&l;code&g;9000&l;/code&g;这两个端口。如果你希望通过Nginx反向代理，那么只开放&l;code&g;7000&l;/code&g;就可以了。&l;/p&g;\n&l;h2 id=\&q;2.客户端配置\&q;&g;2.客户端配置&l;a title=\&q;#2.客户端配置\&q; href=\&q;#2.客户端配置\&q;&g;&l;/a&g;&l;/h2&g;\n&l;h3 id=\&q;2.1-下载\&q;&g;2.1 下载&l;a title=\&q;#2.1-下载\&q; href=\&q;#2.1-下载\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;同样的，我们需要下载frp，并配置frpc的部分运行，请注意与第一部的命令区分&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;uname&l;/span&g; -m&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;在下面的链接（可能需要魔法访问）复制对应架构的最新版的链接：&l;/p&g;\n&l;p&g;&l;a href=\&q;https://github.com/fatedier/frp/releases\&q; target=\&q;_blank\&q;&g;Releases · fatedier/frp (github.com)&l;/a&g;&l;/p&g;\n&l;p&g;下面&l;strong&g;arm&l;/strong&g;为例&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;cd&l;/span&g; /home/&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 下载&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;wget https://github.com/fatedier/frp/releases/download/v0.51.2/frp_0.51.2_linux_arm64.tar.gz&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 创建文件夹解压&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;mkdir&l;/span&g; frp&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;tar -xzf frp_0.51.2_linux_arm64.tar.gz -C frp&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;# 进入目录&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;built_in\&q;&g;cd&l;/span&g; frp/frp_0.51.2_linux_arm64/&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h3 id=\&q;2.2-配置frpc\&q;&g;2.2 配置FRPC&l;a title=\&q;#2.2-配置frpc\&q; href=\&q;#2.2-配置frpc\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;修改frpc的配置文件&l;/p&g;\n&l;figure class=\&q;highlight ini\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;sudo vim frpc.ini&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;文件内配置，需要注意，和&l;code&g;bind_port&l;/code&g;要一致，&l;code&g;auto_token&l;/code&g;也一样。&l;/p&g;\n&l;p&g;&l;code&g;local_ip&l;/code&g;为设备的内网IP，如&l;code&g;192.168.0.122&l;/code&g;&l;/p&g;\n&l;p&g;&l;code&g;local_port&l;/code&g;是HA内网访问的端口号，默认为&l;code&g;8123&l;/code&g;&l;/p&g;\n&l;p&g;&l;code&g;remote_port&l;/code&g;为服务器端要访问的端口号，和&l;code&g;vhost_http_port&l;/code&g;保持一致&l;/p&g;\n&l;p&g;⚠️&l;code&g;login_fail_exit = false&l;/code&g; 这里非常重要，否则中途网络出现问题，frpc服务会自动终止，不能尝试自动重连！&l;/p&g;\n&l;figure class=\&q;highlight ini\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;section\&q;&g;[common]&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;tls_enable&l;/span&g; = &l;span class=\&q;literal\&q;&g;true&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;server_addr&l;/span&g; = 云服务器IP&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;server_port&l;/span&g; = &l;span class=\&q;number\&q;&g;7000&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;auto_token&l;/span&g; = &l;span class=\&q;number\&q;&g;123456&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;login_fail_exit&l;/span&g; = &l;span class=\&q;literal\&q;&g;false&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;section\&q;&g;[VNC1]&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;type&l;/span&g; = http&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;local_ip&l;/span&g; = &l;span class=\&q;number\&q;&g;192.168&l;/span&g;.&l;span class=\&q;number\&q;&g;0.122&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;local_port&l;/span&g; = &l;span class=\&q;number\&q;&g;8123&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;attr\&q;&g;remote_port&l;/span&g; = &l;span class=\&q;number\&q;&g;9000&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h3 id=\&q;2.3配置开机自启\&q;&g;2.3配置开机自启&l;a title=\&q;#2.3配置开机自启\&q; href=\&q;#2.3配置开机自启\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;创建服务，便于管理并随开机自动运行&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;cp&l;/span&g; frpc /usr/local/bin/frpc&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;mkdir&l;/span&g; /etc/frp/  &l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo &l;span class=\&q;built_in\&q;&g;cp&l;/span&g; frpc.ini /etc/frp/frpc.ini &l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;sudo vim /etc/systemd/system/frpc.service&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;创建&l;code&g;frpc.service&l;/code&g;文件&l;/p&g;\n&l;figure class=\&q;highlight plaintext\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;[Unit]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 服务名称，可自定义&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Description = frp server&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;After = network.target syslog.target&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Wants = network.target&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;[Service]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Type = simple&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 启动frpc的命令，需修改为您的frpc的安装路径&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;ExecStart=/usr/local/bin/frpc -c /etc/frp/frpc.ini&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;[Install]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;WantedBy = multi-user.target&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;开启服务，并配置开机启动&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;systemctl start frpc&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;systemctl &l;span class=\&q;built_in\&q;&g;enable&l;/span&g; frpc&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;查看是否运行成功&l;/p&g;\n&l;figure class=\&q;highlight sh\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;systemctl status frpc&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h2 id=\&q;3.配置ha\&q;&g;3.配置HA&l;a title=\&q;#3.配置ha\&q; href=\&q;#3.配置ha\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;此时通过云服务器+&l;code&g;9000&l;/code&g;端口就能打开页面了，如果显示400错误，不用担心，是因为HA有额外的安全设置，需要把代理地址加入白名单才能正常在局域网外访问。&l;/p&g;\n&l;p&g;首先通过插件市场安装File editor用来编辑&l;code&g;/config/configuration.yaml&l;/code&g;配置文件&l;/p&g;\n&l;p&g;在结尾添加配置：&l;/p&g;\n&l;figure class=\&q;highlight plaintext\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;http:&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  base_url: https://your url #外网域名或IP&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  cors_allowed_origins: https:///your url #外网域名或IP&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  use_x_forwarded_for: true&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  trusted_proxies:&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    - 47.103.129.118 #外网IP&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    - 10.0.0.106 #内网IP&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    - 172.18.0.1 #本机地址&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;进入设置，验证&l;code&g;configuration.yaml&l;/code&g;是否能通过，如果不能通过，请仔细检查格式，如果能通过，选择完全重启HA。&l;/p&g;\n&l;p&g;重启后，通过云服务器的域名/IP+端口应该可以直接访问。&l;/p&g;\n&l;p&g;如果不需要自定义域名来访问，那么本教程已经到此结束，休息一下来杯可乐奖励自己！&l;/p&g;\n&l;h2 id=\&q;4.nginx反向代理\&q;&g;4.Nginx反向代理&l;a title=\&q;#4.nginx反向代理\&q; href=\&q;#4.nginx反向代理\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;这部分将带你为HA转发的服务套一层域名“马甲”。需要使用的软件为Nginx Proxy Manager，安装教程可以参考我之前发的这篇：&l;/p&g;\n&l;p&g;&l;a href=\&q;https://wardzhou.art/2021/02/27/NginXProxyManager\&q; target=\&q;_blank\&q;&g;Nginx Proxy Manager——小而美的多容器转发方案 - 白桦 Birch (wardzhou.art)&l;/a&g;&l;/p&g;\n&l;p&g;首先在域名提供商进行解析，创建新的A记录指向你设置的公网IP。这里使用二级域名或者顶级域名都是可以的。&l;/p&g;\n&l;p&g;然后登陆Nginx Proxy Manager的Dashboard，创建新的Proxy，填写内网的IP，这里的获取方式在上述链接中有所提及。&l;/p&g;\n&l;p&g;&l;code&g;Domin Names&l;/code&g;填写刚刚设置的外网地址，选择http，然后切换到&l;code&g;ssl&l;/code&g;选项，申请https证书，稍等证书下发后勾选需要的选项保存。&l;/p&g;\n&l;p&g;此时就可以通过你设置的域名登陆HA啦！&l;/p&g;\n&l;p&g;如果你使用HA的官方APP的话，建议去设置一下外部访问的网址，并把内网的IP与家里的Wi-Fi名绑定，这样就能自动切换，在家访问更快。&l;/p&g;\n&l;p&g;此时&l;code&g;vhost_http_port&l;/code&g;这个端口已经不再需要了，可以去云服务器的安全组关掉。不需要的端口关掉更为安全。&l;/p&g;\n&l;blockquote&g;\n&l;p&g;参考&l;/p&g;\n&l;ol&g;\n&l;li&g;&l;a href=\&q;https://www.cnblogs.com/feiyunhongge/p/17464922.html\&q; target=\&q;_blank\&q;&g;树莓派+阿里云+frp 实现内网穿透 - brilliant_999 - 博客园 (cnblogs.com)&l;/a&g;&l;/li&g;\n&l;li&g;&l;a href=\&q;https://wardzhou.art/2021/02/27/NginXProxyManager\&q; target=\&q;_blank\&q;&g;Nginx Proxy Manager——小而美的多容器转发方案 - 白桦 Birch (wardzhou.art)&l;/a&g;&l;/li&g;\n&l;li&g;&l;a href=\&q;https://community.home-assistant.io/t/home-assistant-400-bad-request-docker-proxy-solution/322163\&q; target=\&q;_blank\&q;&g;Home assistant (400 Bad Request) Docker + Proxy - Solution - Configuration - Home Assistant Community (home-assistant.io)&l;/a&g;&l;/li&g;\n&l;li&g;&l;a href=\&q;https://github.com/fatedier/frp/issues/2605\&q; target=\&q;_blank\&q;&g;第一次链接服务器若网络不可用，则frpc会直接退出。 · Issue #2605 · fatedier/frp · GitHub&l;/a&g;&l;/li&g;\n&l;/ol&g;\n&l;/blockquote&g;\n&q;,&q;prev&q;:{&q;title&q;:&q;Xiaomi 13 Ultra sample shots in Hong Kong&q;,&q;link&q;:&q;2023/12/31/Xiaomi-13-Ultra-HK&q;},&q;next&q;:{&q;title&q;:&q;Hue&q;,&q;link&q;:&q;2022/08/07/Hue&q;},&q;plink&q;:&q;http://wardzhou.art/2023/08/03/ha-frp/&q;,&q;toc&q;:[{&q;id&q;:&q;1.服务器端配置&q;,&q;title&q;:&q;1.服务器端配置&q;,&q;index&q;:&q;1&q;,&q;children&q;:[{&q;id&q;:&q;1.1下载&q;,&q;title&q;:&q;1.1下载&q;,&q;index&q;:&q;1.1&q;},{&q;id&q;:&q;1.2配置frps&q;,&q;title&q;:&q;1.2配置FRPS&q;,&q;index&q;:&q;1.2&q;},{&q;id&q;:&q;1.3配置开机自启&q;,&q;title&q;:&q;1.3配置开机自启&q;,&q;index&q;:&q;1.3&q;}]},{&q;id&q;:&q;2.客户端配置&q;,&q;title&q;:&q;2.客户端配置&q;,&q;index&q;:&q;2&q;,&q;children&q;:[{&q;id&q;:&q;2.1-下载&q;,&q;title&q;:&q;2.1 下载&q;,&q;index&q;:&q;2.1&q;},{&q;id&q;:&q;2.2-配置frpc&q;,&q;title&q;:&q;2.2 配置FRPC&q;,&q;index&q;:&q;2.2&q;},{&q;id&q;:&q;2.3配置开机自启&q;,&q;title&q;:&q;2.3配置开机自启&q;,&q;index&q;:&q;2.3&q;}]},{&q;id&q;:&q;3.配置ha&q;,&q;title&q;:&q;3.配置HA&q;,&q;index&q;:&q;3&q;},{&q;id&q;:&q;4.nginx反向代理&q;,&q;title&q;:&q;4.Nginx反向代理&q;,&q;index&q;:&q;4&q;}],&q;reward&q;:true,&q;copyright&q;:{&q;author&q;:&q;Ward&q;,&q;license&q;:&q;Attribution-NonCommercial-NoDerivatives 4.0 International(&l;a href=\&q;https://creativecommons.org/licenses/by-nc-nd/4.0/\&q; rel=\\\&q;external nofollow\\\&q; target=\\\&q;_blank\\\&q;&g;CC BY-NC-ND 4.0&l;/a&g;)&q;,&q;updated&q;:&q;January 25, 2024&q;},&q;reading_time&q;:&q;1850 words in 12 min&q;}}</script></head><body lang="en"><is-a class="φh" ng-version="12.1.0"><is-k class="φcu"><div class="φdg"><section class="φdh"><header class="φcv"><i class="φda"></i><!----><!----><img width="160" draggable="false" class="φcx φcw" src="https://wardzhou.art/img/avatar.jpeg" alt="Birch" title="Birch"><!----><a href="" class="φcz">Birch</a><p class="φcy">&gt; </p></header><div class="φdl"><a routerlink="/archives" class="φdm" href="/archives"><span>122</span><span>Archives</span></a><a class="φdm" href="/categories/Academic"><span>15</span><span>Categories</span></a><!----><a routerlink="/tags" class="φdm" href="/tags"><span>71</span><span>Tags</span></a><!----></div><!----><nav class="φdi"><a class="φdj" href="/">🏠 Home</a><!----><!----><!----><a class="φdj" href="/search">🔍 Search</a><!----><!----><!----><a class="φdj" href="/resource">🧭 Resource</a><!----><!----><!----><a class="φdj" href="/about">🌈 About</a><!----><!----><!----><!----></nav><!----><div issnippet="" class="φb"></div><!----><!----><!----></section><footer class="φdb φdc"><div class="φde"><!----><a target="_blank" rel="external nofollow noopener" class="φdf" title="Github" href="https://github.com/derbirch"><i class="iκ-github"></i></a><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φdf" title="Instagram" href="https://www.instagram.com/nanyuzhou/"><i class="iκ-instagram"></i></a><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φdf" title="Email" href="mailto:wardzhou@outlook.com"><i class="iκ-email"></i></a><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φdf" title="AO3" href="https://archiveofourown.org/users/orangeShirt"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Archive of Our Own icon</title><path d="M18.417 9.883c-.687 1.116-1.823 1.722-2.99 1.855-4.227.484-6.047-4.149-3.469-6.728 2.31-2.31 7.082-.9 7.005 2.899-.011.611-.166 1.357-.546 1.974zm-6.459-2.029c.142 3.596 4.764 3.682 5.687 1.054.815-2.324-1.12-4.199-3.19-3.897-1.523.221-2.553 1.411-2.497 2.843z"></path><path d="M23.123 6.003c.284-.131.697-.412.837-.246.211.251-.459.475-.748.664-.918.6-1.731 1.227-2.477 2.049-.959 1.059-1.944 2.376-2.55 3.818.618.032 3.021.157 3.6 1.481.464 1.062-.387 2.156-1.32 2.627.663.414 1.81.945 1.745 1.898-.158 2.343-3.696 2.241-5.178.695-.244-.289-.358-.482-.25-.578.151-.134.326.186.676.476.225.187.377.251.572.354 1.301.683 3.339.403 3.478-.792.064-.554-.664-.955-1.217-1.204-.498-.224-1.514-.386-1.494-.952.02-.554.524-.45 1.03-.65.55-.217 1.004-.901 1.003-1.116-.005-.905-2.062-.888-3.221-.92-.275.606-.471 1.226-.692 2.158-.139.583-.151 1.897-.748 2.029-.737.164-1.014-.477-1.455-.991-.594-.69-1.436-1.637-1.942-2.223-3.033 1.002-5.392 2.091-8.256 3.712-1.311.742-2.063 1.59-2.545 1.354-.396-.194-.339-.633-.147-.887.393-.521.927-1.225 1.396-1.888.6-.849 1.054-1.667 1.373-2.445.692-1.688 1.23-4.72 1.475-5.859.088-.412.309-.348.322-.148.027.419-.237 2.047-.29 2.383-.436 2.781-.772 4.41-2.009 6.349 2.196-1.358 4.805-3.019 7.592-3.955C8.846 9.936 5.847 6.85 1.676 4.905 1.037 4.542 0 4.464 0 4.22c0-.271.781-.06 1.043.007 2.383.596 4.817 2.141 6.601 3.444 2.145 1.567 4.714 3.967 5.679 5.081.657-.226 2.286-.457 3.696-.496.752-1.58 2.55-4.018 4.788-5.442.413-.263.842-.594 1.316-.811zm-8.594 8.071c.423.428.742.934 1.11 1.398.174-.59.405-1.216.643-1.758-.619.082-1.281.203-1.753.36z"></path></svg>
</a><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φdf" title="Behance" href="https://www.behance.net/wardzhou/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22 7h-7v-2h7v2zm1.726 10c-.442 1.297-2.029 3-5.101 3-3.074 0-5.564-1.729-5.564-5.675 0-3.91 2.325-5.92 5.466-5.92 3.082 0 4.964 1.782 5.375 4.426.078.506.109 1.188.095 2.14h-8.027c.13 3.211 3.483 3.312 4.588 2.029h3.168zm-7.686-4h4.965c-.105-1.547-1.136-2.219-2.477-2.219-1.466 0-2.277.768-2.488 2.219zm-9.574 6.988h-6.466v-14.967h6.953c5.476.081 5.58 5.444 2.72 6.906 3.461 1.26 3.577 8.061-3.207 8.061zm-3.466-8.988h3.584c2.508 0 2.906-3-.312-3h-3.272v3zm3.391 3h-3.391v3.016h3.341c3.055 0 2.868-3.016.05-3.016z"></path></svg>
</a><!----><!----><!----></div><!----><p class="φe">© 2024 👨‍💻 WardZhou</p><!----><!----><p class="φe"><a href="http://beian.miit.gov.cn/" target="_Blank">辽ICP备20002645号</a></p><!----></footer></div></is-k><div class="φj"><div class="φi"><div class="φn"><main class="φm"><router-outlet></router-outlet><is-r class="φet"><header class="φfd φfn" style="background-image:url(https://cdn.wardzhou.art/img/Screenshot%202023-08-04%20at%2019.55.52.webp);background-color:;"><div class="φfm"><!----><p class="φff"><span class="φfg φfk">Aug 3, 2023</span><a class="φfg φfi" href="/categories/%E6%95%99%E7%A8%8B">教程</a><!----><span class="φfg φfj">1850 words in 12 min</span><!----><!----></p><hr class="φfo"><!----><h1 class="φfp">借助云主机，在外也能访问家中的Home Assistant</h1><!----></div></header><article itemscope="" itemtype="http://schema.org/Article" class="φew" data-title="借助云主机，在外也能访问家中的Home Assistant"><div itemprop="articleBody" issnippet="" iszoomable="" class="φe"><p>Home Assistant (HA)，靠其强大的功能、可拓展性、和社区支持，得到了很多智能家居爱好者的青睐。而在内地复杂的宽带环境下，如何在局域网外访问HA成为最大的痛点之一。如果你正巧有自己的域名和云服务器，那么这篇指南可能是个不错的选择。</p>
<p>Updated on Aug. 23 —— 增加frpc服务连接失败自动重连配置</p>
<blockquote>
<p><strong>10秒速读：本文通过FRP在服务器端和客户端搭建通道，并通过Nginx反向代理来实现自定义域名访问家中的HA实例。</strong></p>
<p>环境：Linux</p>
<p>需要准备：</p>
<ul>
<li>有公网IP的云服务器，并预装Linux系统；</li>
<li>通过<a href="https://www.home-assistant.io/installation/linux" target="_blank">原生OS/Supervisor</a>方式部署好的HA客户端（VM或者Docker可能会有未知问题）</li>
<li>一些耐心</li>
</ul>
</blockquote>
<h2 id="1.服务器端配置">1.服务器端配置<a title="#1.服务器端配置" href="#1.服务器端配置"></a></h2>
<h3 id="1.1下载">1.1下载<a title="#1.1下载" href="#1.1下载"></a></h3>
<p>FRP软件包包含两部分：服务器端的FRPS和客户端的FRPC，该软件包提供跨平台支持，所以需要确定你服务器的架构。使用下面的命令输出：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -m</span><br></pre></td></tr></tbody></table></figure>
<p>在下面的链接（可能需要魔法访问）复制对应架构的最新版的链接：</p>
<p><a href="https://github.com/fatedier/frp/releases" target="_blank">Releases · fatedier/frp (github.com)</a></p>
<p>下面amd64为例</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/</span><br><span class="line"><span class="comment"># 下载</span></span><br><span class="line">wget https://github.com/fatedier/frp/releases/download/v0.51.2/frp_0.51.2_linux_amd64.tar.gz</span><br><span class="line"><span class="comment"># 创建文件夹解压</span></span><br><span class="line"><span class="built_in">mkdir</span> frp</span><br><span class="line">tar -xzf frp_0.51.2_linux_amd64.tar.gz -C frp</span><br><span class="line"><span class="comment"># 进入目录</span></span><br><span class="line"><span class="built_in">cd</span> frp/frp_0.51.2_linux_amd64/</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1.2配置frps">1.2配置FRPS<a title="#1.2配置frps" href="#1.2配置frps"></a></h3>
<p>修改配置文件 <code>frps.ini</code></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim  frps.ini</span><br></pre></td></tr></tbody></table></figure>
<p>文件内容：</p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">bind_port</span> = <span class="number">7000</span></span><br><span class="line"><span class="attr">vhost_http_port</span> = <span class="number">9000</span></span><br><span class="line"><span class="attr">auto_token</span> = <span class="number">123456</span></span><br></pre></td></tr></tbody></table></figure>
<p>vim文件编辑器内输入<code>i</code>进入编辑模式。</p>
<p><code>bind_port</code>是需要绑定的服务器端口，<code>vhost_http_port</code>是你希望通过服务器访问的端口，需要提前确认这两个端口没有被占用</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询端口占用</span></span><br><span class="line">netstat -ntlp</span><br></pre></td></tr></tbody></table></figure>
<p><code>auto_token</code>是用来认证的密钥，可以自定义</p>
<p>配置完成后，按ESC退出编辑模式，输入<code>:w</code>并按回车，紧接着输入<code>:q</code>并按回车保存退出</p>
<h3 id="1.3配置开机自启">1.3配置开机自启<a title="#1.3配置开机自启" href="#1.3配置开机自启"></a></h3>
<p>创建一个服务，便于管理并随开机自动运行</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> frps /usr/local/bin/frps</span><br><span class="line">sudo <span class="built_in">mkdir</span> /etc/frp/  </span><br><span class="line">sudo <span class="built_in">cp</span> frps.ini /etc/frp/frps.ini </span><br><span class="line">sudo vim /etc/systemd/system/frps.service</span><br></pre></td></tr></tbody></table></figure>
<p>创建服务配置文件</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line"># 服务名称，可自定义</span><br><span class="line">Description = frp server</span><br><span class="line">After = network.target syslog.target</span><br><span class="line">Wants = network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type = simple</span><br><span class="line"># 启动frps的命令，需修改为您的frps的安装路径</span><br><span class="line">ExecStart=/usr/local/bin/frps -c /etc/frp/frps.ini</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy = multi-user.target</span><br></pre></td></tr></tbody></table></figure>
<p>编辑和保存命令同上</p>
<p>开启服务，并配置开机启动</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start frps</span><br><span class="line">systemctl <span class="built_in">enable</span> frps</span><br></pre></td></tr></tbody></table></figure>
<p>查看是否运行成功</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status frps</span><br></pre></td></tr></tbody></table></figure>
<p>云服务器一般有安全管理，需要去控制台开放端口，示例里为<code>7000</code>和<code>9000</code>这两个端口。如果你希望通过Nginx反向代理，那么只开放<code>7000</code>就可以了。</p>
<h2 id="2.客户端配置">2.客户端配置<a title="#2.客户端配置" href="#2.客户端配置"></a></h2>
<h3 id="2.1-下载">2.1 下载<a title="#2.1-下载" href="#2.1-下载"></a></h3>
<p>同样的，我们需要下载frp，并配置frpc的部分运行，请注意与第一部的命令区分</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -m</span><br></pre></td></tr></tbody></table></figure>
<p>在下面的链接（可能需要魔法访问）复制对应架构的最新版的链接：</p>
<p><a href="https://github.com/fatedier/frp/releases" target="_blank">Releases · fatedier/frp (github.com)</a></p>
<p>下面<strong>arm</strong>为例</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/</span><br><span class="line"><span class="comment"># 下载</span></span><br><span class="line">wget https://github.com/fatedier/frp/releases/download/v0.51.2/frp_0.51.2_linux_arm64.tar.gz</span><br><span class="line"><span class="comment"># 创建文件夹解压</span></span><br><span class="line"><span class="built_in">mkdir</span> frp</span><br><span class="line">tar -xzf frp_0.51.2_linux_arm64.tar.gz -C frp</span><br><span class="line"><span class="comment"># 进入目录</span></span><br><span class="line"><span class="built_in">cd</span> frp/frp_0.51.2_linux_arm64/</span><br></pre></td></tr></tbody></table></figure>
<h3 id="2.2-配置frpc">2.2 配置FRPC<a title="#2.2-配置frpc" href="#2.2-配置frpc"></a></h3>
<p>修改frpc的配置文件</p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim frpc.ini</span><br></pre></td></tr></tbody></table></figure>
<p>文件内配置，需要注意，和<code>bind_port</code>要一致，<code>auto_token</code>也一样。</p>
<p><code>local_ip</code>为设备的内网IP，如<code>192.168.0.122</code></p>
<p><code>local_port</code>是HA内网访问的端口号，默认为<code>8123</code></p>
<p><code>remote_port</code>为服务器端要访问的端口号，和<code>vhost_http_port</code>保持一致</p>
<p>⚠️<code>login_fail_exit = false</code> 这里非常重要，否则中途网络出现问题，frpc服务会自动终止，不能尝试自动重连！</p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">tls_enable</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">server_addr</span> = 云服务器IP</span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"><span class="attr">auto_token</span> = <span class="number">123456</span></span><br><span class="line"><span class="attr">login_fail_exit</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[VNC1]</span></span><br><span class="line"><span class="attr">type</span> = http</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">192.168</span>.<span class="number">0.122</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">8123</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">9000</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="2.3配置开机自启">2.3配置开机自启<a title="#2.3配置开机自启" href="#2.3配置开机自启"></a></h3>
<p>创建服务，便于管理并随开机自动运行</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> frpc /usr/local/bin/frpc</span><br><span class="line">sudo <span class="built_in">mkdir</span> /etc/frp/  </span><br><span class="line">sudo <span class="built_in">cp</span> frpc.ini /etc/frp/frpc.ini </span><br><span class="line">sudo vim /etc/systemd/system/frpc.service</span><br></pre></td></tr></tbody></table></figure>
<p>创建<code>frpc.service</code>文件</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line"># 服务名称，可自定义</span><br><span class="line">Description = frp server</span><br><span class="line">After = network.target syslog.target</span><br><span class="line">Wants = network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type = simple</span><br><span class="line"># 启动frpc的命令，需修改为您的frpc的安装路径</span><br><span class="line">ExecStart=/usr/local/bin/frpc -c /etc/frp/frpc.ini</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy = multi-user.target</span><br></pre></td></tr></tbody></table></figure>
<p>开启服务，并配置开机启动</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start frpc</span><br><span class="line">systemctl <span class="built_in">enable</span> frpc</span><br></pre></td></tr></tbody></table></figure>
<p>查看是否运行成功</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status frpc</span><br></pre></td></tr></tbody></table></figure>
<h2 id="3.配置ha">3.配置HA<a title="#3.配置ha" href="#3.配置ha"></a></h2>
<p>此时通过云服务器+<code>9000</code>端口就能打开页面了，如果显示400错误，不用担心，是因为HA有额外的安全设置，需要把代理地址加入白名单才能正常在局域网外访问。</p>
<p>首先通过插件市场安装File editor用来编辑<code>/config/configuration.yaml</code>配置文件</p>
<p>在结尾添加配置：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http:</span><br><span class="line">  base_url: https://your url #外网域名或IP</span><br><span class="line">  cors_allowed_origins: https:///your url #外网域名或IP</span><br><span class="line">  use_x_forwarded_for: true</span><br><span class="line">  trusted_proxies:</span><br><span class="line">    - 47.103.129.118 #外网IP</span><br><span class="line">    - 10.0.0.106 #内网IP</span><br><span class="line">    - 172.18.0.1 #本机地址</span><br></pre></td></tr></tbody></table></figure>
<p>进入设置，验证<code>configuration.yaml</code>是否能通过，如果不能通过，请仔细检查格式，如果能通过，选择完全重启HA。</p>
<p>重启后，通过云服务器的域名/IP+端口应该可以直接访问。</p>
<p>如果不需要自定义域名来访问，那么本教程已经到此结束，休息一下来杯可乐奖励自己！</p>
<h2 id="4.nginx反向代理">4.Nginx反向代理<a title="#4.nginx反向代理" href="#4.nginx反向代理"></a></h2>
<p>这部分将带你为HA转发的服务套一层域名“马甲”。需要使用的软件为Nginx Proxy Manager，安装教程可以参考我之前发的这篇：</p>
<p><a href="https://wardzhou.art/2021/02/27/NginXProxyManager" target="_blank">Nginx Proxy Manager——小而美的多容器转发方案 - 白桦 Birch (wardzhou.art)</a></p>
<p>首先在域名提供商进行解析，创建新的A记录指向你设置的公网IP。这里使用二级域名或者顶级域名都是可以的。</p>
<p>然后登陆Nginx Proxy Manager的Dashboard，创建新的Proxy，填写内网的IP，这里的获取方式在上述链接中有所提及。</p>
<p><code>Domin Names</code>填写刚刚设置的外网地址，选择http，然后切换到<code>ssl</code>选项，申请https证书，稍等证书下发后勾选需要的选项保存。</p>
<p>此时就可以通过你设置的域名登陆HA啦！</p>
<p>如果你使用HA的官方APP的话，建议去设置一下外部访问的网址，并把内网的IP与家里的Wi-Fi名绑定，这样就能自动切换，在家访问更快。</p>
<p>此时<code>vhost_http_port</code>这个端口已经不再需要了，可以去云服务器的安全组关掉。不需要的端口关掉更为安全。</p>
<blockquote>
<p>参考</p>
<ol>
<li><a href="https://www.cnblogs.com/feiyunhongge/p/17464922.html" target="_blank">树莓派+阿里云+frp 实现内网穿透 - brilliant_999 - 博客园 (cnblogs.com)</a></li>
<li><a href="https://wardzhou.art/2021/02/27/NginXProxyManager" target="_blank">Nginx Proxy Manager——小而美的多容器转发方案 - 白桦 Birch (wardzhou.art)</a></li>
<li><a href="https://community.home-assistant.io/t/home-assistant-400-bad-request-docker-proxy-solution/322163" target="_blank">Home assistant (400 Bad Request) Docker + Proxy - Solution - Configuration - Home Assistant Community (home-assistant.io)</a></li>
<li><a href="https://github.com/fatedier/frp/issues/2605" target="_blank">第一次链接服务器若网络不可用，则frpc会直接退出。 · Issue #2605 · fatedier/frp · GitHub</a></li>
</ol>
</blockquote>
</div><is-e class="φu"><!----><ul class="φy"><li class="φw"><strong class="φx">Author<span>:</span></strong><p class="φv">Ward</p></li><li class="φw"><strong class="φx">Copyright<span>:</span></strong><p class="φv">Attribution-NonCommercial-NoDerivatives 4.0 International(<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" rel="\&quot;external" target="\&quot;_blank\&quot;">CC BY-NC-ND 4.0</a>)</p></li><li class="φw"><strong class="φx">Updated<span>:</span></strong><p class="φv">January 25, 2024</p></li><!----></ul><!----></is-e><!----><is-j class="φcm"><p class="φcr">Buy me snacks 🍩.</p><div class="φco"><div class="φct"><a class="φcs φa iκ-wechat" style="color:;"></a><a class="φcs φa iκ-paypal" style="color:;"></a><a class="φcs" style="color:;">支</a><!----></div><div class="φcq"><!----></div></div></is-j><!----><div><div issnippet="" class="φb"><link href="custom/font-awesome/css/font-awesome.min.css" rel="stylesheet"><link href="custom/clipboard.css" rel="stylesheet"></div><div issnippet="" class="φb"></div><!----></div><!----></article><footer class="φex"><div class="φfc"><is-l class="φdo"><a class="φdp" href="/tags/HomeAssistant">HomeAssistant</a></is-l><is-l class="φdo"><a class="φdp" href="/tags/Linux">Linux</a></is-l><is-l class="φdo"><a class="φdp" href="/tags/Nginx">Nginx</a></is-l><is-l class="φdo"><a class="φdp" href="/tags/SmartHome">SmartHome</a></is-l><!----></div><!----><div class="φey"><a class="φez φfb" href="/2023/12/31/Xiaomi-13-Ultra-HK">Xiaomi 13 Ultra sample shots in Hong Kong</a><!----><a class="φez φfa" href="/2022/08/07/Hue">Hue</a><!----></div><!----></footer><is-d class="φt"><div issnippet=""><div id="vcomment"></div></div><!----></is-d><!----><!----><!----></is-r><!----></main><!----></div></div></div><is-f class="φz"><div class="φbi"><span class="φa iκ-up"></span><span class="φa iκ-down"></span><!----><span class="φa iκ-toc"></span><!----><span class="φa iκ-search"></span><!----></div><div class="φbb φbc"><svg class="φbh"><defs><filter id="dp"><feGaussianBlur in="SourceGraphic" stdDeviation="2"></feGaussianBlur></filter></defs><circle filter="url(#dp)" fill="rgba(0,0,0,.3)" cx="50%" cy="52%" r="44%"></circle><circle cx="50%" cy="50%" r="44%" class="φbd"></circle><circle cx="50%" cy="50%" r="48%" class="φbg" stroke-dasharray="0% 314.15926%"></circle><!----><g class="φbe"><circle r=".2rem" cx="0" cy="-.8rem"></circle><circle r=".2rem"></circle><circle r=".2rem" cx="0" cy=".8rem"></circle></g><!----></svg></div></is-f><is-m class="φdq"><div class="φds φdt"><a class="φdv"><span class="φdx">1 </span><!----><span class="φdy">1.服务器端配置</span></a><div class="φds"><a class="φdv"><span class="φdx">1.1 </span><!----><span class="φdy">1.1下载</span></a><!----></div><div class="φds"><a class="φdv"><span class="φdx">1.2 </span><!----><span class="φdy">1.2配置FRPS</span></a><!----></div><div class="φds"><a class="φdv"><span class="φdx">1.3 </span><!----><span class="φdy">1.3配置开机自启</span></a><!----></div><!----><!----><!----></div><div class="φds φdt"><a class="φdv"><span class="φdx">2 </span><!----><span class="φdy">2.客户端配置</span></a><div class="φds"><a class="φdv"><span class="φdx">2.1 </span><!----><span class="φdy">2.1 下载</span></a><!----></div><div class="φds"><a class="φdv"><span class="φdx">2.2 </span><!----><span class="φdy">2.2 配置FRPC</span></a><!----></div><div class="φds"><a class="φdv"><span class="φdx">2.3 </span><!----><span class="φdy">2.3配置开机自启</span></a><!----></div><!----><!----><!----></div><div class="φds φdt"><a class="φdv"><span class="φdx">3 </span><!----><span class="φdy">3.配置HA</span></a><!----></div><div class="φds φdt"><a class="φdv"><span class="φdx">4 </span><!----><span class="φdy">4.Nginx反向代理</span></a><!----></div><!----></is-m><!----><!----></is-a><script src="/runtime.1ed960b0635ea0669f87.js"></script><script src="/polyfills.b7bf56fc45f931a8b83e.js"></script><script src="/main.543c891b4aad158701f3.js"></script></body></html>